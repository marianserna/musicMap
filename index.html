<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Arsenal" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <title>map</title>

  </head>
  <body>

    <div id="landing">
      <video autoplay loop>
        <source src="../video/finalRender.mp4" type="video/mp4">
        Sorry, your browser does not support the video tag.
      </video>

      <!-- <nav id="web-nav">
        <span>Search music by</span>
        <ul>
          <li class="web-nav-item"><a href="#">Country</a></li>
          <li class="web-nav-item"><a href="#">Genre</a></li>
        </ul>
      </nav> -->
    </div>

    <div id="auth">
      <div class="login" onclick="db.signin()">
        <i class="fa fa-twitter fa-2x" aria-hidden="true"></i>
        <span>Log in with Twitter</span>
      </div>
    </div>

    <div id="container">

      <div id="search">
        <div id="chart-search">
          <form id="chart-search-form">
            <select id="chart-search-input">
              <option value='all-music'>All Music</option>
              <option value='all-audio'>All Audio</option>
              <option value='alternativerock'>Alternative Rock</option>
              <option value='ambient'>Ambient</option>
              <option value='classical'>Classical</option>
              <option value='country'>Country</option>
              <option value='danceedm'>Dance EDM</option>
              <option value='dancehall'>Dance Hall</option>
              <option value='deephouse'>Deephouse</option>
              <option value='disco'>Disco</option>
              <option value='drumbass'>Drumbass</option>
              <option value='dubstep'>Dubstep</option>
              <option value='electronic'>Electronic</option>
              <option value='folksingersongwriter'>Folk</option>
              <option value='hiphoprap'>Hip Hop</option>
            </select>
            <button type="search" name="button">Find</button>
          </form>

          <div id="chart-search-results">

          </div>
        </div>

        <div id="map-search">
          <canvas id="canvas"></canvas>
          <span>Click on a country - rotate map if needed -</span>
          <div id="map-search-results"></div>
        </div>

        <div id="name-search">
          <form id="name-search-form">
            <input type="text" name="search" value="" placeholder="Search" id="name-search-input">
            <button type="search" name="button">Find</button>
          </form>

          <div id="name-search-results">
          </div>
        </div>

      </div>

      <div id="playlist">
        <h1>playlist here</h1>
        <div id="player"></div>
        <a href="#" id="play-all">Play All <i class="fa fa-play"></i></a>
        <div id="playdrop"></div>
      </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/3.6.8/firebase.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r83/three.js"></script>
    <script src="https://connect.soundcloud.com/sdk/sdk-3.1.2.js"></script>
    <script src="https://use.fontawesome.com/036ff7566f.js"></script>
    <script src="https://w.soundcloud.com/player/api.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js"></script>

    <script src="js/vendor/OrbitControls.js"></script>
    <script src="js/vendor/Map3dGeometry.js"></script>
    <script src="js/vendor/Projector.js"></script>

    <script src="js/Database.js"></script>
    <script src="js/Map.js"></script>
    <script src="js/Earth.js"></script>
    <script src="js/SoundCloud.js"></script>
    <script src="js/Playlist.js"></script>
    <script src="js/Search.js"></script>
    <script src="js/Recent.js"></script>

    <script>
      const database = new Database();
      const sound = new SoundCloud();
      const playlist = new Playlist();
      const search = new Search(sound);
      search.searchByTerm('nutcracker');

      fetch('/js/geo.json').then((response) => {
        return response.json();
      }).then((geoData) => {
        init(geoData);
      });

      function init(geoData) {
        window.map = new Map();
        map.addLights();

        const planet = new Earth(geoData);
        map.scene.add(planet.globeMesh);

        map.addRayCasting(planet.globeMesh, (name) => {
          planet.colourCountry(name);
          database.searchCountry(name);
        });

        navigator.geolocation.getCurrentPosition((position) => {
          planet.addPoint(
            position.coords.latitude,
            position.coords.longitude
          );
          database.setCountry(
            position.coords.latitude,
            position.coords.longitude
          );
        });

        requestAnimationFrame(render);

        function render() {
          map.renderer.render(map.scene, map.camera);
          planet.globeMesh.rotation.y += 0.001;
          requestAnimationFrame(render);
        }
      }

    </script>
  </body>
</html>
